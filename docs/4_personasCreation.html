<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Personas Creation – Sondondo Project Notebooks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6e5bad59d9c561bd033d0b48217d8615.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./1_dataCleaning.html">Notebooks</a></li><li class="breadcrumb-item"><a href="./4_personasCreation.html">Personas Creation</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Sondondo Project Notebooks</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true">
 <span class="menu-text">Notebooks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_dataCleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_placeMapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Place Mapping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_termExtraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Textual Variation Analysis for ‘Conditions’ Columns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_personasCreation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Personas Creation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_visualizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualizations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./docpages/metadata_dictionary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metadata Dictionary</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#personas-data-structure" id="toc-personas-data-structure" class="nav-link active" data-scroll-target="#personas-data-structure">Personas Data Structure</a></li>
  <li><a href="#data-extraction" id="toc-data-extraction" class="nav-link" data-scroll-target="#data-extraction">Data Extraction</a>
  <ul class="collapse">
  <li><a href="#initial-exploration" id="toc-initial-exploration" class="nav-link" data-scroll-target="#initial-exploration">Initial Exploration</a></li>
  </ul></li>
  <li><a href="#quality-assessment" id="toc-quality-assessment" class="nav-link" data-scroll-target="#quality-assessment">Quality Assessment</a>
  <ul class="collapse">
  <li><a href="#name-completeness" id="toc-name-completeness" class="nav-link" data-scroll-target="#name-completeness">Name Completeness</a></li>
  <li><a href="#parental-linkage-completeness" id="toc-parental-linkage-completeness" class="nav-link" data-scroll-target="#parental-linkage-completeness">Parental Linkage Completeness</a></li>
  <li><a href="#temporal-completeness" id="toc-temporal-completeness" class="nav-link" data-scroll-target="#temporal-completeness">Temporal Completeness</a></li>
  <li><a href="#spatial-completeness" id="toc-spatial-completeness" class="nav-link" data-scroll-target="#spatial-completeness">Spatial Completeness</a></li>
  <li><a href="#attribute-completeness" id="toc-attribute-completeness" class="nav-link" data-scroll-target="#attribute-completeness">Attribute Completeness</a></li>
  <li><a href="#aggregate-completeness-metrics" id="toc-aggregate-completeness-metrics" class="nav-link" data-scroll-target="#aggregate-completeness-metrics">Aggregate Completeness Metrics</a></li>
  </ul></li>
  <li><a href="#summary-and-implications" id="toc-summary-and-implications" class="nav-link" data-scroll-target="#summary-and-implications">Summary and Implications</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./1_dataCleaning.html">Notebooks</a></li><li class="breadcrumb-item"><a href="./4_personasCreation.html">Personas Creation</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Personas Creation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Our approach aligns closely with the input preparation model proposed by David W. Embley (<a href="https://doi.org/10.1007/978-3-030-88358-4_6">2021</a>). We structure our data around <em>personas</em>, defined as “each mention instance of a person in a document” (p.&nbsp;66), as a foundational step toward probabilistic record linkage (PRL). Each <em>persona</em> is created by ingesting available individual metadata (such as name, last name, birth date), associating the person with a sacramental event (baptism, marriage, or burial). The relationship between personas is established by their participation at the event (e.g., as father, mother, godfather, witness).</p>
<section id="personas-data-structure" class="level2">
<h2 class="anchored" data-anchor-id="personas-data-structure">Personas Data Structure</h2>
<p>The <code>personas</code> data structure is very straightforward:</p>
<ul>
<li>event_idno: unique semantically meaningful identifier for the event</li>
<li>persona_idno: unique semantically meaningful identifier for the persona</li>
<li>persona_type: role of the persona in the event (e.g., baptized, father, mother, witness)</li>
<li>name: first name of the persona</li>
<li>last_name: last name of the persona</li>
<li>birth_date: birth date of the persona</li>
<li>birth_place: birth place of the persona</li>
<li>resident_in: persona residence at the time of the event</li>
<li>gender: inferred gender of the persona</li>
<li>social_condition: harmonized social condition of the persona</li>
<li>legitimacy_status: harmonized legitimacy status of the persona</li>
<li>marital_status: harmonized marital status of the persona</li>
</ul>
<p>Identification of individuals is done by parsing one or a list of dataframes with the clean data, and processing the data using the <code>Persona</code> class. Results are stored in <code>data/interim/personas_extracted.csv</code> for testing, and in <code>data/clean/personas.csv</code> for production.</p>
</section>
<section id="data-extraction" class="level2">
<h2 class="anchored" data-anchor-id="data-extraction">Data Extraction</h2>
<p>We begin by loading the cleaned sacramental records and extracting persona instances using the <code>PersonaExtractor</code> class. This process creates individual persona records for each person mentioned in the historical documents, preserving their role in each event.</p>
<div id="e0b706ae" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> actions.extractors <span class="im">import</span> Persona</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="019460f5" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>bautismos <span class="op">=</span> pd.read_csv(<span class="st">"../data/clean/bautismos_clean.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>entierros <span class="op">=</span> pd.read_csv(<span class="st">"../data/clean/entierros_clean.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>matrimonios <span class="op">=</span> pd.read_csv(<span class="st">"../data/clean/matrimonios_clean.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="96e68625" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>extractor <span class="op">=</span> Persona.PersonaExtractor([bautismos, matrimonios, entierros])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>personas <span class="op">=</span> extractor.extract_personas()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>personas.describe(include<span class="op">=</span><span class="st">'all'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">event_idno</th>
<th data-quarto-table-cell-role="th">original_identifier</th>
<th data-quarto-table-cell-role="th">persona_type</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">birth_place</th>
<th data-quarto-table-cell-role="th">birth_date</th>
<th data-quarto-table-cell-role="th">legitimacy_status</th>
<th data-quarto-table-cell-role="th">lastname</th>
<th data-quarto-table-cell-role="th">persona_idno</th>
<th data-quarto-table-cell-role="th">social_condition</th>
<th data-quarto-table-cell-role="th">marital_status</th>
<th data-quarto-table-cell-role="th">resident_in</th>
<th data-quarto-table-cell-role="th">death_place</th>
<th data-quarto-table-cell-role="th">death_date</th>
<th data-quarto-table-cell-role="th">gender</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>47072</td>
<td>47072</td>
<td>47072</td>
<td>46999</td>
<td>5378</td>
<td>8596</td>
<td>11866</td>
<td>46762</td>
<td>47072</td>
<td>9643</td>
<td>4275</td>
<td>925</td>
<td>1513</td>
<td>2114</td>
<td>47072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">unique</td>
<td>10180</td>
<td>10179</td>
<td>14</td>
<td>4286</td>
<td>53</td>
<td>7001</td>
<td>2</td>
<td>2616</td>
<td>47072</td>
<td>7</td>
<td>3</td>
<td>19</td>
<td>7</td>
<td>1813</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">top</td>
<td>matrimonio-490</td>
<td>APAucará-LM-L001_M490</td>
<td>mother</td>
<td>mariano</td>
<td>pampamarca</td>
<td>1901-09-04</td>
<td>legitimo</td>
<td>quispe</td>
<td>persona-1</td>
<td>indio</td>
<td>soltero</td>
<td>pampamarca</td>
<td>aucará</td>
<td>1871-11-04</td>
<td>male</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">freq</td>
<td>12</td>
<td>12</td>
<td>7614</td>
<td>1556</td>
<td>1919</td>
<td>8</td>
<td>9104</td>
<td>2712</td>
<td>1</td>
<td>5654</td>
<td>2779</td>
<td>292</td>
<td>1016</td>
<td>7</td>
<td>20150</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="initial-exploration" class="level3">
<h3 class="anchored" data-anchor-id="initial-exploration">Initial Exploration</h3>
<p>Before conducting detailed quality assessment, we examine the basic structure and distribution of persona types in the extracted dataset.</p>
<div id="88f66de1" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>personas.to_csv(<span class="st">"../data/clean/personas.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="00b68c9e" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>personas.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 47072 entries, 0 to 47071
Data columns (total 15 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   event_idno           47072 non-null  object
 1   original_identifier  47072 non-null  object
 2   persona_type         47072 non-null  object
 3   name                 46999 non-null  object
 4   birth_place          5378 non-null   object
 5   birth_date           8596 non-null   object
 6   legitimacy_status    11866 non-null  object
 7   lastname             46762 non-null  object
 8   persona_idno         47072 non-null  object
 9   social_condition     9643 non-null   object
 10  marital_status       4275 non-null   object
 11  resident_in          925 non-null    object
 12  death_place          1513 non-null   object
 13  death_date           2114 non-null   object
 14  gender               47072 non-null  object
dtypes: object(15)
memory usage: 5.4+ MB</code></pre>
</div>
</div>
</section>
</section>
<section id="quality-assessment" class="level2">
<h2 class="anchored" data-anchor-id="quality-assessment">Quality Assessment</h2>
<p>To evaluate the suitability of the extracted personas for probabilistic record linkage, we assess data completeness across multiple dimensions: names, parental linkages, temporal information, spatial attributes, and social/legal status markers.</p>
<p>Names are critical identifiers for record linkage. We assess the completeness of both first names and surnames across all persona types.</p>
<section id="name-completeness" class="level3">
<h3 class="anchored" data-anchor-id="name-completeness">Name Completeness</h3>
<div id="b2f2b0fa" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>name_completeness <span class="op">=</span> personas.loc[(personas[<span class="st">'name'</span>].isna()) <span class="op">|</span> (personas[<span class="st">'lastname'</span>].isna())]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>name_completeness.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 383 entries, 62 to 46928
Data columns (total 15 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   event_idno           383 non-null    object
 1   original_identifier  383 non-null    object
 2   persona_type         383 non-null    object
 3   name                 310 non-null    object
 4   birth_place          35 non-null     object
 5   birth_date           52 non-null     object
 6   legitimacy_status    41 non-null     object
 7   lastname             73 non-null     object
 8   persona_idno         383 non-null    object
 9   social_condition     55 non-null     object
 10  marital_status       20 non-null     object
 11  resident_in          0 non-null      object
 12  death_place          26 non-null     object
 13  death_date           53 non-null     object
 14  gender               383 non-null    object
dtypes: object(15)
memory usage: 47.9+ KB</code></pre>
</div>
</div>
<div id="e641938b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>name_completeness[<span class="st">'persona_type'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>persona_type
mother               83
deceased             53
father_of_husband    45
father_of_wife       45
father               44
godmother            27
godfather            25
godparent            13
wife                 13
witness              10
husband               9
mother_of_wife        7
mother_of_husband     5
baptized              4
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="886bdc32" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentage of missing names</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>total_personas <span class="op">=</span> <span class="bu">len</span>(personas)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>missing_names <span class="op">=</span> <span class="bu">len</span>(name_completeness)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>percentage_missing_names <span class="op">=</span> (missing_names <span class="op">/</span> total_personas) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with missing names: </span><span class="sc">{</span>percentage_missing_names<span class="sc">:.2f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with missing names: 0.81%</code></pre>
</div>
</div>
<div id="e784a515" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>missing_firstnames <span class="op">=</span> personas.loc[personas[<span class="st">'name'</span>].isna()]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>percentage_missing_firstnames <span class="op">=</span> (<span class="bu">len</span>(missing_firstnames) <span class="op">/</span> total_personas) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with missing firstnames: </span><span class="sc">{</span>percentage_missing_firstnames<span class="sc">:.2f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with missing firstnames: 0.16%</code></pre>
</div>
</div>
<div id="d5d15827" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>missing_surnames <span class="op">=</span> personas.loc[personas[<span class="st">'lastname'</span>].isna()]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>percentage_missing_surnames <span class="op">=</span> (<span class="bu">len</span>(missing_surnames) <span class="op">/</span> total_personas) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with missing lastnames: </span><span class="sc">{</span>percentage_missing_surnames<span class="sc">:.2f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with missing lastnames: 0.66%</code></pre>
</div>
</div>
</section>
<section id="parental-linkage-completeness" class="level3">
<h3 class="anchored" data-anchor-id="parental-linkage-completeness">Parental Linkage Completeness</h3>
<p>For personas identified as children (baptized, deceased children, etc.), we assess whether their parents are properly linked in the dataset. The expectation differs by legitimacy status: legitimate children should have both parents recorded, while illegitimate children require at least one parent.</p>
<div id="88227ba5" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>legitimate_sons <span class="op">=</span> personas.loc[personas[<span class="st">'legitimacy_status'</span>] <span class="op">==</span> <span class="st">'legitimo'</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ilegitimate_sons <span class="op">=</span> personas.loc[personas[<span class="st">'legitimacy_status'</span>] <span class="op">==</span> <span class="st">'ilegitimo'</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>sons_types <span class="op">=</span> legitimate_sons[<span class="st">'persona_type'</span>].unique().tolist()</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># filter ilegitimate sons by sons types to avoid including other ilegitimate personas</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>ilegitimate_sons <span class="op">=</span> ilegitimate_sons.loc[ilegitimate_sons[<span class="st">'persona_type'</span>].isin(sons_types)]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Legitimate Sons Persona Types and Counts:"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(legitimate_sons[<span class="st">'persona_type'</span>].value_counts())</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Ilegitimate Sons Persona Types and Counts:"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ilegitimate_sons[<span class="st">'persona_type'</span>].value_counts())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Legitimate Sons Persona Types and Counts:
persona_type
baptized    5483
wife        1267
husband     1248
deceased    1106
Name: count, dtype: int64

Ilegitimate Sons Persona Types and Counts:
persona_type
baptized    810
deceased    201
wife        170
husband     165
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="f1dfcd14" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_parents_completeness(sons_df, personas_df, legitimacy<span class="op">=</span><span class="st">'leg'</span>):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get unique event_idno from sons</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    event_ids <span class="op">=</span> sons_df[<span class="st">'event_idno'</span>].unique()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter personas to only relevant events</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    relevant_personas <span class="op">=</span> personas_df[personas_df[<span class="st">'event_idno'</span>].isin(event_ids)]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check for father and mother presence by event</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    events_with_father <span class="op">=</span> <span class="bu">set</span>(relevant_personas[relevant_personas[<span class="st">'persona_type'</span>].<span class="bu">str</span>.contains(<span class="st">'father'</span>, na<span class="op">=</span><span class="va">False</span>)][<span class="st">'event_idno'</span>])</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    events_with_mother <span class="op">=</span> <span class="bu">set</span>(relevant_personas[relevant_personas[<span class="st">'persona_type'</span>].<span class="bu">str</span>.contains(<span class="st">'mother'</span>, na<span class="op">=</span><span class="va">False</span>)][<span class="st">'event_idno'</span>])</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> legitimacy <span class="op">==</span> <span class="st">'leg'</span>:</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For legitimate sons, both parents should be present</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Incomplete if missing father OR missing mother</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        events_missing_father <span class="op">=</span> <span class="bu">set</span>(event_ids) <span class="op">-</span> events_with_father</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        events_missing_mother <span class="op">=</span> <span class="bu">set</span>(event_ids) <span class="op">-</span> events_with_mother</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>        incomplete_events <span class="op">=</span> events_missing_father <span class="op">|</span> events_missing_mother</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> legitimacy <span class="op">==</span> <span class="st">'ileg'</span>:</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For illegitimate sons, at least one parent should be present</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Incomplete if missing BOTH father AND mother</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        incomplete_events <span class="op">=</span> <span class="bu">set</span>(event_ids) <span class="op">-</span> events_with_father <span class="op">-</span> events_with_mother</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Legitimacy must be 'leg' or 'ileg'"</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get sons with incomplete parents</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    incomplete_sons <span class="op">=</span> sons_df[sons_df[<span class="st">'event_idno'</span>].isin(incomplete_events)]</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> incomplete_sons</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>incomplete_legit_parents <span class="op">=</span> check_parents_completeness(legitimate_sons, personas)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>incomplete_ilegit_parents <span class="op">=</span> check_parents_completeness(ilegitimate_sons, personas, legitimacy<span class="op">=</span><span class="st">'ileg'</span>)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of legitimate sons with incomplete parents: </span><span class="sc">{</span><span class="bu">len</span>(incomplete_legit_parents)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of ilegitimate sons with incomplete parents: </span><span class="sc">{</span><span class="bu">len</span>(incomplete_ilegit_parents)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of legitimate sons with incomplete parents: 42
Number of ilegitimate sons with incomplete parents: 9</code></pre>
</div>
</div>
<p>The results show excellent parental linkage quality:</p>
<ul>
<li><strong>Legitimate personas</strong> (9,110 total): Only 0.46% (42 cases) have incomplete parental records</li>
<li><strong>Illegitimate personas</strong> (1,310 total): Only 0.68% (9 cases) lack at least one parent</li>
</ul>
<p>This high completeness rate indicates that the extraction process successfully preserved family relationships recorded in the sacramental registers.</p>
</section>
<section id="temporal-completeness" class="level3">
<h3 class="anchored" data-anchor-id="temporal-completeness">Temporal Completeness</h3>
<p>We assess the availability of birth and death dates, which are essential for temporal reasoning in record linkage.</p>
<div id="dc1e4491" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nobirthdate <span class="op">=</span> personas.loc[personas[<span class="st">'birth_date'</span>].isna()]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>personas_size <span class="op">=</span> <span class="bu">len</span>(personas)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>nobirthdate_size <span class="op">=</span> <span class="bu">len</span>(nobirthdate)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>percentage_nobirthdate <span class="op">=</span> (nobirthdate_size <span class="op">/</span> personas_size) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with missing birth dates: </span><span class="sc">{</span>percentage_nobirthdate<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>nobirthdate[<span class="st">'persona_type'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with missing birth dates: 81.74%</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>persona_type
mother               7614
father               7369
witness              4249
godparent            3260
godmother            3251
godfather            3012
wife                 1470
mother_of_wife       1459
husband              1441
mother_of_husband    1439
father_of_wife       1438
father_of_husband    1410
baptized              978
deceased               86
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="2b581232" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>nodeathdate <span class="op">=</span> personas.loc[personas[<span class="st">'death_date'</span>].isna()]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>nodeathdate_size <span class="op">=</span> <span class="bu">len</span>(nodeathdate)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>percentage_nodeathdate <span class="op">=</span> (nodeathdate_size <span class="op">/</span> personas_size) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with missing death dates: </span><span class="sc">{</span>percentage_nodeathdate<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>nodeathdate[<span class="st">'persona_type'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with missing death dates: 95.51%</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>persona_type
mother               7614
father               7369
baptized             6340
witness              4249
godparent            3260
godmother            3251
godfather            3012
wife                 2060
husband              2051
mother_of_wife       1459
mother_of_husband    1439
father_of_wife       1438
father_of_husband    1410
deceased                6
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="spatial-completeness" class="level3">
<h3 class="anchored" data-anchor-id="spatial-completeness">Spatial Completeness</h3>
<p>Birth and death places provide geographic context for mobility analysis and help disambiguate between individuals with similar names.</p>
<div id="5b502e43" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>nonbirthplace <span class="op">=</span> personas.loc[personas[<span class="st">'birth_place'</span>].isna()]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>nonbirthplace_size <span class="op">=</span> <span class="bu">len</span>(nonbirthplace)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>percentage_nonbirthplace <span class="op">=</span> (nonbirthplace_size <span class="op">/</span> personas_size) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with missing birth places: </span><span class="sc">{</span>percentage_nonbirthplace<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>nonbirthplace[<span class="st">'persona_type'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with missing birth places: 88.57%</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>persona_type
mother               7614
father               7369
baptized             4532
witness              4249
godparent            3260
godmother            3251
godfather            3012
mother_of_wife       1459
mother_of_husband    1439
father_of_wife       1438
father_of_husband    1410
wife                 1154
husband              1114
deceased              393
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="13dbc696" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>nodeathplace <span class="op">=</span> personas.loc[personas[<span class="st">'death_place'</span>].isna()]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>nodeathplace_size <span class="op">=</span> <span class="bu">len</span>(nodeathplace)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>percentage_nodeathplace <span class="op">=</span> (nodeathplace_size <span class="op">/</span> personas_size) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with missing death places: </span><span class="sc">{</span>percentage_nodeathplace<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>nodeathplace[<span class="st">'persona_type'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with missing death places: 96.79%</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>persona_type
mother               7614
father               7369
baptized             6340
witness              4249
godparent            3260
godmother            3251
godfather            3012
wife                 2060
husband              2051
mother_of_wife       1459
mother_of_husband    1439
father_of_wife       1438
father_of_husband    1410
deceased              607
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="fefe7c38" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># personas with both birth and death places present</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>birth_and_death_places <span class="op">=</span> personas.loc[personas[<span class="st">'birth_place'</span>].notna() <span class="op">&amp;</span> personas[<span class="st">'death_place'</span>].notna()]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>birth_and_death_places_size <span class="op">=</span> <span class="bu">len</span>(birth_and_death_places)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>percentage_birth_and_death_places <span class="op">=</span> (birth_and_death_places_size <span class="op">/</span> personas_size) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with both birth and death places present: </span><span class="sc">{</span>percentage_birth_and_death_places<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>birth_and_death_places[<span class="st">'persona_type'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with both birth and death places present: 2.59%</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>persona_type
deceased    1219
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="attribute-completeness" class="level3">
<h3 class="anchored" data-anchor-id="attribute-completeness">Attribute Completeness</h3>
<p>We examine the completeness of harmonized social and legal status attributes (legitimacy, marital status, social condition), which provide contextual information that can strengthen or weaken linkage hypotheses.</p>
<div id="032ac0f9" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>legitimacy_missing <span class="op">=</span> personas.loc[personas[<span class="st">'legitimacy_status'</span>].isna()]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>legitimacy_missing_size <span class="op">=</span> <span class="bu">len</span>(legitimacy_missing)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>percentage_legitimacy_missing <span class="op">=</span> (legitimacy_missing_size <span class="op">/</span> personas_size) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with missing legitimacy status: </span><span class="sc">{</span>percentage_legitimacy_missing<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>legitimacy_missing[<span class="st">'persona_type'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with missing legitimacy status: 74.79%</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>persona_type
mother               7608
father               7365
witness              4249
godparent            3258
godmother            3248
godfather            3008
mother_of_wife       1113
father_of_wife       1093
mother_of_husband    1085
father_of_husband    1058
deceased              813
husband               638
wife                  623
baptized               47
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="056b1940" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>marital_status_missing <span class="op">=</span> personas.loc[personas[<span class="st">'marital_status'</span>].isna()]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>marital_status_missing_size <span class="op">=</span> <span class="bu">len</span>(marital_status_missing)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>percentage_marital_status_missing <span class="op">=</span> (marital_status_missing_size <span class="op">/</span> personas_size) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with missing marital status: </span><span class="sc">{</span>percentage_marital_status_missing<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>marital_status_missing[<span class="st">'persona_type'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with missing marital status: 90.92%</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>persona_type
mother               7550
father               7362
baptized             6340
witness              4249
godmother            3250
godparent            3241
godfather            3011
mother_of_wife       1459
mother_of_husband    1438
father_of_wife       1438
father_of_husband    1410
deceased              917
wife                  586
husband               546
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cf0c481e" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>social_condition_missing <span class="op">=</span> personas.loc[personas[<span class="st">'social_condition'</span>].isna()]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>social_condition_missing_size <span class="op">=</span> <span class="bu">len</span>(social_condition_missing)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>percentage_social_condition_missing <span class="op">=</span> (social_condition_missing_size <span class="op">/</span> personas_size) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage of personas with missing social condition: </span><span class="sc">{</span>percentage_social_condition_missing<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>social_condition_missing[<span class="st">'persona_type'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage of personas with missing social condition: 79.51%</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>persona_type
mother               6715
father               6564
baptized             4338
witness              4249
godparent            2967
godfather            2922
godmother            2901
wife                 1196
husband              1145
mother_of_wife        955
father_of_wife        938
mother_of_husband     938
father_of_husband     917
deceased              684
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="aggregate-completeness-metrics" class="level3">
<h3 class="anchored" data-anchor-id="aggregate-completeness-metrics">Aggregate Completeness Metrics</h3>
<p>Beyond individual field completeness, we calculate overall completeness scores to understand the general quality of persona records. We compute both a simple completeness score (proportion of non-null fields) and a weighted score that prioritizes critical fields for record linkage.</p>
<section id="simple-completeness-score" class="level4">
<h4 class="anchored" data-anchor-id="simple-completeness-score">Simple Completeness Score</h4>
<p>The simple score treats all fields equally, providing a general measure of data richness.</p>
<div id="ec0eacb6" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>personas[<span class="st">'completeness_score'</span>] <span class="op">=</span> personas.notna().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) <span class="op">/</span> <span class="bu">len</span>(personas.columns)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>personas.groupby(<span class="st">'persona_type'</span>)[<span class="st">'completeness_score'</span>].mean().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>persona_type
deceased             0.821415
husband              0.656038
wife                 0.651748
baptized             0.629243
mother_of_husband    0.506092
mother_of_wife       0.505186
father_of_husband    0.504492
father_of_wife       0.503755
mother               0.474424
father               0.473651
godmother            0.473372
godparent            0.472822
godfather            0.468216
witness              0.466510
Name: completeness_score, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="weighted-completeness-score" class="level4">
<h4 class="anchored" data-anchor-id="weighted-completeness-score">Weighted Completeness Score</h4>
<p>The weighted score assigns higher importance to fields crucial for record linkage (names, dates) and lower weights to supplementary attributes (social condition, residence). This reflects the differential utility of fields in matching algorithms.</p>
<div id="a33d08fc" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> {</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: <span class="fl">0.15</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lastname'</span>: <span class="fl">0.15</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'birth_date'</span>: <span class="fl">0.125</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'death_date'</span>: <span class="fl">0.125</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'birth_place'</span>: <span class="fl">0.10</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'death_place'</span>: <span class="fl">0.10</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'legitimacy_status'</span>: <span class="fl">0.05</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'marital_status'</span>: <span class="fl">0.05</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'social_condition'</span>: <span class="fl">0.05</span>,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'gender'</span>: <span class="fl">0.05</span>,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'resident_in'</span>: <span class="fl">0.05</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> weighted_completeness(row, weights):</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col, w <span class="kw">in</span> weights.items():</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pd.notna(row[col]):</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>            score <span class="op">+=</span> w</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>personas[<span class="st">'weighted_completeness'</span>] <span class="op">=</span> personas.<span class="bu">apply</span>(weighted_completeness, axis<span class="op">=</span><span class="dv">1</span>, weights<span class="op">=</span>weights)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>personas.groupby(<span class="st">'persona_type'</span>)[<span class="st">'weighted_completeness'</span>].mean().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>persona_type
deceased             0.836722
baptized             0.549558
husband              0.536738
wife                 0.531650
mother_of_husband    0.379222
mother_of_wife       0.378410
father_of_husband    0.375177
father_of_wife       0.374687
mother               0.354728
father               0.354641
godparent            0.354218
godmother            0.354199
godfather            0.350332
witness              0.349647
Name: weighted_completeness, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="comparison-of-completeness-metrics" class="level4">
<h4 class="anchored" data-anchor-id="comparison-of-completeness-metrics">Comparison of Completeness Metrics</h4>
<p>Visualizing the relationship between simple and weighted completeness reveals how different persona types vary in their possession of high-priority fields.</p>
<div id="18ad6c77" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot correlation between completeness_score and weighted_completeness</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>personas, x<span class="op">=</span><span class="st">'completeness_score'</span>, y<span class="op">=</span><span class="st">'weighted_completeness'</span>, hue<span class="op">=</span><span class="st">'persona_type'</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation between Completeness Score and Weighted Completeness'</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Completeness Score'</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Weighted Completeness'</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Persona Type'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="4_personasCreation_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="summary-and-implications" class="level2">
<h2 class="anchored" data-anchor-id="summary-and-implications">Summary and Implications</h2>
<p>The quality assessment reveals that the persona extraction process successfully preserved historical information with high fidelity:</p>
<ul>
<li><strong>Name completeness</strong> is excellent for most persona types, with missing names concentrated in expected categories (e.g., godparents, witnesses)</li>
<li><strong>Parental linkages</strong> are nearly complete (&gt;99%) for both legitimate and illegitimate children, enabling family reconstruction</li>
<li><strong>Temporal and spatial data</strong> show variable completeness depending on persona type, reflecting the original documentary practices</li>
<li><strong>Weighted completeness scores</strong> indicate that core linkage fields (names, dates) are well-populated across persona types</li>
</ul>
<p>These results suggest that the dataset is well-suited for probabilistic record linkage, with sufficient information density to support robust matching algorithms while retaining the historical nuances present in the original sacramental registers.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Sondondo Parish Records Project</strong> v0.3.0<br>
<a href="https://ampl.clair.ucsb.edu/project/sondondo">UCSB Archives, Memory &amp; Preservation Lab</a></p>
</div>   
    <div class="nav-footer-center">
<p>Licensed under <a href="https://github.com/UCSB-AMPLab/sondondo/blob/main/LICENSE">MIT License</a></p>
</div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a><br>
<a href="https://github.com/UCSB-AMPLab/sondondo"><i class="bi bi-github"></i> Source</a></p>
</div>
  </div>
</footer>




</body></html>